/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */
package GUI;

import BUS.ThongKeBUS;
import DTO.ThongKe;
import DTO.ThongKeTheoNamDTO;
import java.awt.BorderLayout;
import java.util.List;
import javax.swing.JOptionPane;
import org.jfree.chart.ChartFactory;
import org.jfree.chart.ChartPanel;
import org.jfree.chart.JFreeChart;
import org.jfree.data.category.DefaultCategoryDataset;

/**
 *
 * @author V≈©Nguy·ªÖn
 */
public class ThongKeNamFrame extends javax.swing.JFrame {

    /**
     * Creates new form ThongKeNamFrame
     */
    public ThongKeNamFrame() {
        initComponents();
        hienThiThongKe();
    }

    private void hienThiThongKe() {
    List<ThongKeTheoNamDTO> danhSach = ThongKeBUS.thongKeTongHopTheoNam();

    txtAreaThongKe.setText("");
    txtAreaThongKe.append("üìä TH·ªêNG K√ä S√ÅCH THEO NƒÇM\n");
    txtAreaThongKe.append("===========================\n");

    for (ThongKeTheoNamDTO dto : danhSach) {
        txtAreaThongKe.append("üìÖ NƒÉm: " + dto.getNam() + "\n");
        txtAreaThongKe.append("   üìò T·ªïng ƒë√£ cho m∆∞·ª£n: " + dto.getTongDaChoMuon() + "\n");
        txtAreaThongKe.append("   üìó T·ªïng c√≤n l·∫°i     : " + dto.getTongConLai() + "\n");
        txtAreaThongKe.append("   üí∞ T·ªïng ti·ªÅn ph·∫°t   : " + dto.getTongTienPhat() + " VND\n");
        txtAreaThongKe.append("---------------------------\n");
    }

    hienThiBieuDoMuon(danhSach);
    hienThiBieuDoPhat(danhSach);
}

private void hienThiBieuDoMuon(List<ThongKeTheoNamDTO> danhSach) {
    DefaultCategoryDataset dataset = new DefaultCategoryDataset();
    for (ThongKeTheoNamDTO dto : danhSach) {
        dataset.addValue(dto.getTongDaChoMuon(), "S√°ch ƒë√£ cho m∆∞·ª£n", String.valueOf(dto.getNam()));
    }

    JFreeChart lineChart = ChartFactory.createLineChart(
        "Bi·ªÉu ƒë·ªì S√°ch ƒë√£ cho m∆∞·ª£n theo nƒÉm",
        "NƒÉm",
        "S·ªë l∆∞·ª£ng",
        dataset
    );

    ChartPanel chartPanel = new ChartPanel(lineChart);
    chartPanel.setPreferredSize(new java.awt.Dimension(600, 280));
    jPanelChartMuon.removeAll();
    jPanelChartMuon.setLayout(new BorderLayout());
    jPanelChartMuon.add(chartPanel, BorderLayout.CENTER);
    jPanelChartMuon.validate();
}

private void hienThiBieuDoPhat(List<ThongKeTheoNamDTO> danhSach) {
    DefaultCategoryDataset dataset = new DefaultCategoryDataset();
    for (ThongKeTheoNamDTO dto : danhSach) {
        dataset.addValue(dto.getTongTienPhat(), "Ti·ªÅn ph·∫°t", String.valueOf(dto.getNam()));
    }


    JFreeChart lineChart = ChartFactory.createLineChart(
        "Bi·ªÉu ƒë·ªì Ti·ªÅn ph·∫°t theo nƒÉm",
        "NƒÉm",
        "Ti·ªÅn ph·∫°t (VND)",
        dataset
    );

    ChartPanel chartPanel = new ChartPanel(lineChart);
    chartPanel.setPreferredSize(new java.awt.Dimension(600, 280));
    jPanelChartPhat.removeAll();
    jPanelChartPhat.setLayout(new BorderLayout());
    jPanelChartPhat.add(chartPanel, BorderLayout.CENTER);
    jPanelChartPhat.validate();
}



    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        scrollPaneThongKe = new javax.swing.JScrollPane();
        txtAreaThongKe = new javax.swing.JTextArea();
        jLabel1 = new javax.swing.JLabel();
        jPanelChartMuon = new javax.swing.JPanel();
        jPanelChartPhat = new javax.swing.JPanel();
        jMenuBar_sach = new javax.swing.JMenuBar();
        menu_Sach = new javax.swing.JMenu();
        menu_thuThu = new javax.swing.JMenu();
        menu_muonTra = new javax.swing.JMenu();
        menu_qlTheLoai = new javax.swing.JMenu();
        menu_qlDocGia = new javax.swing.JMenu();
        menu_qlTacGia = new javax.swing.JMenu();
        menu_thongKe = new javax.swing.JMenu();
        menu_dxuat1 = new javax.swing.JMenu();
        menu_dxuat = new javax.swing.JMenu();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jPanel1.setBackground(new java.awt.Color(255, 255, 153));

        txtAreaThongKe.setColumns(20);
        txtAreaThongKe.setRows(5);
        scrollPaneThongKe.setViewportView(txtAreaThongKe);

        jLabel1.setFont(new java.awt.Font("Segoe UI", 1, 36)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(248, 155, 40));
        jLabel1.setText("Th·ªëng K√™ theo nƒÉm");
        jLabel1.setToolTipText("");

        jPanelChartMuon.setPreferredSize(new java.awt.Dimension(900, 400));

        javax.swing.GroupLayout jPanelChartMuonLayout = new javax.swing.GroupLayout(jPanelChartMuon);
        jPanelChartMuon.setLayout(jPanelChartMuonLayout);
        jPanelChartMuonLayout.setHorizontalGroup(
            jPanelChartMuonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 608, Short.MAX_VALUE)
        );
        jPanelChartMuonLayout.setVerticalGroup(
            jPanelChartMuonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 281, Short.MAX_VALUE)
        );

        jPanelChartPhat.setPreferredSize(new java.awt.Dimension(900, 400));

        javax.swing.GroupLayout jPanelChartPhatLayout = new javax.swing.GroupLayout(jPanelChartPhat);
        jPanelChartPhat.setLayout(jPanelChartPhatLayout);
        jPanelChartPhatLayout.setHorizontalGroup(
            jPanelChartPhatLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );
        jPanelChartPhatLayout.setVerticalGroup(
            jPanelChartPhatLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 283, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(29, 29, 29)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 342, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(scrollPaneThongKe, javax.swing.GroupLayout.PREFERRED_SIZE, 378, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(jPanelChartMuon, javax.swing.GroupLayout.DEFAULT_SIZE, 608, Short.MAX_VALUE)
                            .addComponent(jPanelChartPhat, javax.swing.GroupLayout.DEFAULT_SIZE, 608, Short.MAX_VALUE))))
                .addContainerGap(29, Short.MAX_VALUE))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                .addComponent(jLabel1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(scrollPaneThongKe)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jPanelChartMuon, javax.swing.GroupLayout.PREFERRED_SIZE, 281, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanelChartPhat, javax.swing.GroupLayout.DEFAULT_SIZE, 283, Short.MAX_VALUE)))
                .addContainerGap())
        );

        jMenuBar_sach.setBackground(new java.awt.Color(255, 242, 201));
        jMenuBar_sach.setForeground(new java.awt.Color(248, 155, 40));
        jMenuBar_sach.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));

        menu_Sach.setText("Qu·∫£n l√Ω s√°ch");
        menu_Sach.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                menu_SachMouseClicked(evt);
            }
        });
        jMenuBar_sach.add(menu_Sach);

        menu_thuThu.setText("Qu·∫£n l√Ω th·ªß th∆∞");
        menu_thuThu.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                menu_thuThuMouseClicked(evt);
            }
        });
        menu_thuThu.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menu_thuThuActionPerformed(evt);
            }
        });
        jMenuBar_sach.add(menu_thuThu);

        menu_muonTra.setText("Qu·∫£n l√Ω m∆∞·ª£n tr·∫£ s√°ch");
        menu_muonTra.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                menu_muonTraMouseClicked(evt);
            }
        });
        jMenuBar_sach.add(menu_muonTra);

        menu_qlTheLoai.setText("Qu·∫£n l√Ω th·ªÉ lo·∫°i");
        menu_qlTheLoai.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                menu_qlTheLoaiMouseClicked(evt);
            }
        });
        jMenuBar_sach.add(menu_qlTheLoai);

        menu_qlDocGia.setText("Qu·∫£n l√Ω ƒë·ªôc gi·∫£");
        menu_qlDocGia.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                menu_qlDocGiaMouseClicked(evt);
            }
        });
        jMenuBar_sach.add(menu_qlDocGia);

        menu_qlTacGia.setText("Qu·∫£n l√Ω t√°c gi·∫£");
        menu_qlTacGia.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                menu_qlTacGiaMouseClicked(evt);
            }
        });
        jMenuBar_sach.add(menu_qlTacGia);

        menu_thongKe.setText("Th·ªëng k√™");
        menu_thongKe.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                menu_thongKeMouseClicked(evt);
            }
        });
        jMenuBar_sach.add(menu_thongKe);

        menu_dxuat1.setForeground(new java.awt.Color(248, 155, 40));
        menu_dxuat1.setText("L·ªãch S·ª≠");
        menu_dxuat1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                menu_dxuat1MouseClicked(evt);
            }
        });
        jMenuBar_sach.add(menu_dxuat1);

        menu_dxuat.setText("ƒêƒÉng xu·∫•t");
        menu_dxuat.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                menu_dxuatMouseClicked(evt);
            }
        });
        jMenuBar_sach.add(menu_dxuat);

        setJMenuBar(jMenuBar_sach);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 176, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 97, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void menu_SachMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_menu_SachMouseClicked
        fSach sachFrame = new fSach();
        sachFrame.setDefaultCloseOperation(fSach.EXIT_ON_CLOSE);
        sachFrame.setLocationRelativeTo(null);
        sachFrame.setVisible(true);
        this.dispose();
    }//GEN-LAST:event_menu_SachMouseClicked

    private void menu_thuThuMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_menu_thuThuMouseClicked
        fThuThu thuThuFrame = new fThuThu();
        thuThuFrame.setDefaultCloseOperation(fThuThu.EXIT_ON_CLOSE);
        thuThuFrame.setLocationRelativeTo(null);
        thuThuFrame.setVisible(true);
        this.dispose();
    }//GEN-LAST:event_menu_thuThuMouseClicked

    private void menu_thuThuActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menu_thuThuActionPerformed

    }//GEN-LAST:event_menu_thuThuActionPerformed

    private void menu_muonTraMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_menu_muonTraMouseClicked
        fMuonTra muonTraFrame = new fMuonTra();
        muonTraFrame.setDefaultCloseOperation(fMuonTra.EXIT_ON_CLOSE);
        muonTraFrame.setLocationRelativeTo(null);
        muonTraFrame.setVisible(true);
        this.dispose();
    }//GEN-LAST:event_menu_muonTraMouseClicked

    private void menu_qlTheLoaiMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_menu_qlTheLoaiMouseClicked
        fTheLoai theLoaiFrame = new fTheLoai();
        theLoaiFrame.setDefaultCloseOperation(EXIT_ON_CLOSE);
        theLoaiFrame.setLocationRelativeTo(null);
        theLoaiFrame.setVisible(true);
        this.dispose();
    }//GEN-LAST:event_menu_qlTheLoaiMouseClicked

    private void menu_qlDocGiaMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_menu_qlDocGiaMouseClicked
        fDocGia docGiaFrame = new fDocGia();
        docGiaFrame.setDefaultCloseOperation(EXIT_ON_CLOSE);
        docGiaFrame.setLocationRelativeTo(null);
        docGiaFrame.setVisible(true);
        this.dispose();
    }//GEN-LAST:event_menu_qlDocGiaMouseClicked

    private void menu_qlTacGiaMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_menu_qlTacGiaMouseClicked
        fTacGia tacGiaFrame = new fTacGia();
        tacGiaFrame.setDefaultCloseOperation(EXIT_ON_CLOSE);
        tacGiaFrame.setLocationRelativeTo(null);
        tacGiaFrame.setVisible(true);
        this.dispose();
    }//GEN-LAST:event_menu_qlTacGiaMouseClicked

    private void menu_thongKeMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_menu_thongKeMouseClicked
        fThongKe thongKeFrame = new fThongKe();
        thongKeFrame.setDefaultCloseOperation(EXIT_ON_CLOSE);
        thongKeFrame.setLocationRelativeTo(null);
        thongKeFrame.setVisible(true);
        this.dispose();
    }//GEN-LAST:event_menu_thongKeMouseClicked

    private void menu_dxuat1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_menu_dxuat1MouseClicked
        // TODO add your handling code here:
        fLichSu lichsuFrame = new fLichSu();
        lichsuFrame.setDefaultCloseOperation(EXIT_ON_CLOSE);
        lichsuFrame.setLocationRelativeTo(null);
        lichsuFrame.setVisible(true);
        this.dispose();
    }//GEN-LAST:event_menu_dxuat1MouseClicked

    private void menu_dxuatMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_menu_dxuatMouseClicked
        // Hi·ªÉn th·ªã h·ªôp tho·∫°i
        int result = JOptionPane.showConfirmDialog(this,
            "B·∫°n c√≥ mu·ªën ƒëƒÉng xu·∫•t kh√¥ng?", "Th√¥ng b√°o",
            JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE);

        // N·∫øu click "yes"
        if (result == JOptionPane.YES_OPTION) {
            JOptionPane.showMessageDialog(this, "B·∫°n ƒë√£ ƒëƒÉng xu·∫•t t√†i kho·∫£n th√†nh c√¥ng");
            this.dispose();

            fDangNhap login = new fDangNhap();
            login.setLocationRelativeTo(null);
            login.setVisible(true);
        }
    }//GEN-LAST:event_menu_dxuatMouseClicked

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(ThongKeNamFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(ThongKeNamFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(ThongKeNamFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(ThongKeNamFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new ThongKeNamFrame().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel jLabel1;
    private javax.swing.JMenuBar jMenuBar_sach;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanelChartMuon;
    private javax.swing.JPanel jPanelChartPhat;
    private javax.swing.JMenu menu_Sach;
    private javax.swing.JMenu menu_dxuat;
    private javax.swing.JMenu menu_dxuat1;
    private javax.swing.JMenu menu_muonTra;
    private javax.swing.JMenu menu_qlDocGia;
    private javax.swing.JMenu menu_qlTacGia;
    private javax.swing.JMenu menu_qlTheLoai;
    private javax.swing.JMenu menu_thongKe;
    private javax.swing.JMenu menu_thuThu;
    private javax.swing.JScrollPane scrollPaneThongKe;
    private javax.swing.JTextArea txtAreaThongKe;
    // End of variables declaration//GEN-END:variables
}
